---
title: "Readme"
author: "Me"
date: "10/19/2018"
output: md_document
---

```{r setup, include=FALSE}
library(prepr)
data(titanic, package="onyx")
knitr::opts_chunk$set(echo = TRUE)
```

## Preparation R

This package is used to temporarily relieve swelling, burning, pain, and itching caused by data preparation. Heavily influenced by sklearn preprocessing module. As such it aims to 
implement the Transformer API and allow for pipelines that can be saved and applied to 
new datasets.

It will eventually include methods for outputting to PMML or json to assist with productionalizing data preparation steps.

```{r Fit & Transform}

## create a onehot encoder
oh <- OnehotEncoder(levels=list(Sex="male", Pclass=c("1", "3")))

## fit the scaler using a data.frame
oh$fit(titanic)

## transform each column of data.frame 
head(oh$transform(head(titanic)))
```

## Specify Subset of Columns

All transformers take a `cols` argument. It can be a character vector of column name which limits the transformer operations to just those columns. Optionally, "factor" or "numeric" can be specified to limit opertions to just columns of those types. Most transformers have a default value for the `cols` argument that makes sense for the operation.

```{r Filter Columns}

mm <- MinMaxScaler(feature_range=c(-1, 1), cols=c("disp", "hp", "wt"))
z <- mm$fit_transform(mtcars)

## only specified columns are transformed
sapply(z, range)
```

### Pipelines

Pipelines simply chain together transformers in a list. They implement the Transformer API as well and support the same methods. Columns can also have an optional `cols` argument that will limit all pipeline operations to the columns specified.

```{r Pipelines}
## chain together in a pipeline
p <- pipeline(
  MinMaxScaler(feature_range=c(-1, 1)),
  StandardImputer(method="median"),
  OnehotEncoder(levels=list(Sex="male", Pclass=c("1", "3"))),
  OnehotEncoder()) ## The rest

z <- p$fit_transform(titanic[-1])

head(z)
```

Note that the order of the pipeline transformers is important. If you pass numeric transformers after onehot encoders for example, the onehot output will be transformed as it is now numeric. As of yet there is no mechanism for preventing this from happening or warning the user.


